const _0x3cebd2=_0x5056;(function(_0x3d319d,_0x57557c){const _0x1a478e=_0x5056,_0x3c656e=_0x3d319d();while(!![]){try{const _0x161641=-parseInt(_0x1a478e(0xe2))/0x1*(parseInt(_0x1a478e(0x117))/0x2)+parseInt(_0x1a478e(0xfe))/0x3+parseInt(_0x1a478e(0xe5))/0x4+-parseInt(_0x1a478e(0x165))/0x5*(parseInt(_0x1a478e(0x127))/0x6)+parseInt(_0x1a478e(0x15f))/0x7*(-parseInt(_0x1a478e(0x152))/0x8)+parseInt(_0x1a478e(0x10d))/0x9*(parseInt(_0x1a478e(0x101))/0xa)+-parseInt(_0x1a478e(0x182))/0xb*(-parseInt(_0x1a478e(0xd6))/0xc);if(_0x161641===_0x57557c)break;else _0x3c656e['push'](_0x3c656e['shift']());}catch(_0x479348){_0x3c656e['push'](_0x3c656e['shift']());}}}(_0x2d5d,0x3a2b2));const bodyParser=require(_0x3cebd2(0x155)),cors=require(_0x3cebd2(0x10a)),express=require(_0x3cebd2(0xd3)),fs=require('fs'),path=require(_0x3cebd2(0x17c)),{v4:uuidv4}=require('uuid'),archiver=require(_0x3cebd2(0xf7)),os=require('os'),{exec}=require(_0x3cebd2(0x190)),networkInterfaces=os['networkInterfaces'](),serverIp=Object[_0x3cebd2(0xdd)](networkInterfaces)[_0x3cebd2(0x12e)]()[_0x3cebd2(0x16c)](_0x171265=>!_0x171265[_0x3cebd2(0x119)]&&_0x171265[_0x3cebd2(0x109)]===_0x3cebd2(0x173))?.['address']||'localhost',main_dir='files',multer=require('multer'),uploadSessionsDir=path[_0x3cebd2(0x14f)](process[_0x3cebd2(0x159)](),'temp_upload_sessions'),tempDir=path[_0x3cebd2(0x14f)](process[_0x3cebd2(0x159)](),_0x3cebd2(0xe7)),mainDir=path['join'](process['cwd'](),main_dir);function _0x5056(_0x558c9f,_0xe12d9f){const _0x2d5d0b=_0x2d5d();return _0x5056=function(_0x505651,_0x243539){_0x505651=_0x505651-0xd1;let _0x13d58f=_0x2d5d0b[_0x505651];return _0x13d58f;},_0x5056(_0x558c9f,_0xe12d9f);}if(!fs[_0x3cebd2(0x12c)](tempDir))fs[_0x3cebd2(0xef)](tempDir,{'recursive':!![]});if(!fs['existsSync'](uploadSessionsDir))fs[_0x3cebd2(0xef)](uploadSessionsDir,{'recursive':!![]});if(!fs[_0x3cebd2(0x12c)](mainDir))fs[_0x3cebd2(0xef)](mainDir,{'recursive':!![]});const storage=multer[_0x3cebd2(0x154)]({'destination':(_0x4542c6,_0x4cb5e3,_0x4984a2)=>_0x4984a2(null,tempDir),'filename':(_0x3f324f,_0x9a3e39,_0x34e58c)=>_0x34e58c(null,uuidv4())}),upload=multer({'storage':storage}),{authenticateUser,encodeAuth,decodeAuth}=require(_0x3cebd2(0x15d)),evelodbConfig=require(_0x3cebd2(0x141)),eveloDB=require(_0x3cebd2(0x188));function _0x2d5d(){const _0x4eaa1f=['http://localhost:3958','Access-Control-Allow-Headers','delete','You\x20don\x27t\x20have\x20permission\x20to\x20delete\x20files','path','body','Access-Control-Allow-Methods','rename','exports','mkdir','3263359GbNfnZ','map','.zip\x22','Access-Control-Allow-Origin','/api/create-file','Update\x20completed\x20successfully','evelodb','create','name','Update\x20failed','all','readdirSync','application/zip','You\x20don\x27t\x20have\x20permission\x20to\x20create\x20files','child_process','User\x20deleted\x20successfully','put','express','pm2\x20restart\x20','\x20uploaded','12nURyFE','Failed\x20to\x20create\x20folder','headers','unlinkSync','count','sizeLimit','length','values','Username\x20and\x20password\x20must\x20be\x20at\x20least\x203\x20characters\x20long','/api/download','basename','Failed\x20to\x20delete\x20directory','34NaUvrH','\x20&&\x20','isDirectory','155352bxELju','permissions','temp_uploads','Item\x20renamed\x20successfully','use','promises','message','Upload\x20failed','Invalid\x20authentication','File\x20creation\x20error:','mkdirSync','dirname','size','json','replace','GET,\x20POST,\x20PUT,\x20DELETE,\x20PATCH,\x20OPTIONS','No\x20authorization\x20token\x20provided','/filemanager/dist','archiver','Cleanup\x20error:','includes','fileSizeLimit','Settings\x20updated\x20successfully','Content-Type','finalize','1372008NsLugD','header','urlencoded','10OLqQkp','log','readFileSync','Failed\x20to\x20create\x20file','authorization','edit','100GB','/api/delete/*','family','cors','File\x20or\x20directory\x20not\x20found','isFile','222444QVrEMi','Downloading:','catch','https://cdn.evelocore.com','Login\x20successful','role','/api/getusers','/api/settings','/api/login','post','12346zhWyjN','User\x20updated\x20successfully','internal','http://localhost:3000','download','admin','setHeader','/api/rename','check','File\x20uploaded\x20successfully','user','Content-Disposition','2gb','Failed\x20to\x20read\x20directory','pipe','Missing\x20required\x20fields','6YJMuNP','read','array','/api/edituser/:username','get','existsSync','Chunk\x20','flat','normalize','files','statSync','utf8','attachment;\x20filename=\x22','You\x20don\x27t\x20have\x20permission\x20to\x20download\x20files','You\x20don\x27t\x20have\x20permission\x20to\x20read\x20this\x20directory','Only\x20administrators\x20can\x20modify\x20settings','PORT','directory','/api/content/*','git\x20stash','file','username','/apitest/pulse','User\x20created\x20successfully','/api/download-zip/*','Username\x20already\x20exists','./middleware/evelodb-config','Directory\x20size\x20exceeds\x20download\x20limit','write','current-directory','unlink','zip','readdir','https://xdtsc7cg-3958.asse.devtunnels.ms','rmdirSync','single','users','status','evelocore-cdn','readFile','join','startsWith','auth','1584NjSAmZ','User\x20not\x20found','diskStorage','body-parser','500GB','./config','isArray','cwd','paths','mtime','You\x20don\x27t\x20have\x20permission\x20to\x20write\x20files','./middleware/auth','/api/upload-chunk','1533eocWnP','You\x20don\x27t\x20have\x20permission\x20to\x20rename\x20files','params','Failed\x20to\x20update\x20user','end','static','1630285lTnnnF','content-length','git\x20pull','.part','/api/writecontent/*','push','exit','find','upload','success','error','Storage\x20limit\x20exceeded','Access\x20denied','You\x20don\x27t\x20have\x20permission\x20to\x20create\x20folders','IPv4','/filemanager','stat','writeFileSync','query'];_0x2d5d=function(){return _0x4eaa1f;};return _0x2d5d();}let db;try{db=new eveloDB(evelodbConfig);}catch(_0x33e4c9){console[_0x3cebd2(0x16f)]('Failed\x20to\x20initialize\x20database:',_0x33e4c9),process[_0x3cebd2(0x16b)](0x1);}function localLogger(_0x28b78b,_0x406938){const _0x475d8a=_0x3cebd2;console[_0x475d8a(0x102)](_0x406938,_0x28b78b);}const {calculateDirectorySize,formatSize,parseSizeLimit,requireAdmin}=require('./middleware/tools');function setupApiRoutes(_0x6946a9){const _0xef3c09=_0x3cebd2,_0x52ecef=[_0xef3c09(0x110),_0xef3c09(0x178),_0xef3c09(0x11a),_0xef3c09(0x148)],_0x19d12b={'origin':(_0x2fe926,_0xcf3e42)=>{!_0x2fe926||_0x52ecef['includes'](_0x2fe926)?_0xcf3e42(null,!![]):_0xcf3e42(new Error('Blocked\x20by\x20CORS\x20policy'));},'credentials':!![]};_0x6946a9[_0xef3c09(0xe9)](cors()),_0x6946a9[_0xef3c09(0xe9)]((_0x4d8e11,_0x46127a,_0x3bf2d9)=>{const _0x46e1e7=_0xef3c09;_0x46127a[_0x46e1e7(0xff)](_0x46e1e7(0x185),'*'),_0x46127a[_0x46e1e7(0xff)](_0x46e1e7(0x17e),_0x46e1e7(0xf4)),_0x46127a['header'](_0x46e1e7(0x179),_0x46e1e7(0xfc)),_0x3bf2d9();}),_0x6946a9[_0xef3c09(0xe9)](express[_0xef3c09(0xf2)]({'limit':_0xef3c09(0x123)})),_0x6946a9['use'](express[_0xef3c09(0x100)]({'limit':_0xef3c09(0x123),'extended':!![]})),_0x6946a9['use'](express[_0xef3c09(0x164)](process[_0xef3c09(0x159)]()+'/homepage')),_0x6946a9[_0xef3c09(0xe9)]('/files',express['static'](process[_0xef3c09(0x159)]()+'/'+main_dir)),_0x6946a9[_0xef3c09(0xe9)](_0xef3c09(0x174),express[_0xef3c09(0x164)](process[_0xef3c09(0x159)]()+_0xef3c09(0xf6))),_0x6946a9[_0xef3c09(0xe9)](bodyParser[_0xef3c09(0xf2)]());const {getConfig:_0x4acc62,writeConfig:_0x24a8ec,updateConfig:_0x3ee6df}=require('./middleware/dataManager');_0x6946a9['post'](_0xef3c09(0x114),authenticateUser,(_0x26f84e,_0x39b011)=>{const _0x39d755=_0xef3c09;if(_0x26f84e[_0x39d755(0x121)][_0x39d755(0x112)]!==_0x39d755(0x11c))return _0x39b011[_0x39d755(0x14c)](0x193)['json']({'error':_0x39d755(0x136)});const _0x3a379a=_0x26f84e[_0x39d755(0x17d)];_0x3ee6df(_0x3a379a);const _0x2c62a2=_0x4acc62();_0x39b011[_0x39d755(0xf2)]({'success':!![],'message':_0x39d755(0xfb),'data':_0x2c62a2});}),_0x6946a9[_0xef3c09(0x12b)](_0xef3c09(0x114),async(_0x3761fe,_0x48baf2)=>{const _0x3ffc38=_0xef3c09,_0x5b6497=_0x4acc62(),_0x16f1c6=path[_0x3ffc38(0x14f)](process[_0x3ffc38(0x159)](),main_dir),_0x6d7a80=formatSize(await calculateDirectorySize(_0x16f1c6)),_0x2186b0=require(_0x3ffc38(0x157));_0x48baf2[_0x3ffc38(0xf2)]({'success':!![],'data':{..._0x5b6497,'usedStorage':_0x6d7a80,'port':_0x2186b0[_0x3ffc38(0x137)]}});}),_0x6946a9[_0xef3c09(0x116)](_0xef3c09(0x115),async(_0x23fa1d,_0x54bf44)=>{const _0x11d9f5=_0xef3c09;let {username:_0x5878cc,password:_0x4516eb,auth:auth=''}=_0x23fa1d[_0x11d9f5(0x17d)];if(auth){[_0x5878cc,_0x4516eb]=decodeAuth(auth);if(!_0x5878cc||!_0x4516eb)return _0x54bf44['status'](0x191)[_0x11d9f5(0xf2)]({'error':_0x11d9f5(0xed)});}if(_0x5878cc[_0x11d9f5(0xdc)]<0x3||_0x4516eb[_0x11d9f5(0xdc)]<0x3)return _0x54bf44[_0x11d9f5(0x14c)](0x190)[_0x11d9f5(0xf2)]({'error':_0x11d9f5(0xde)});const _0x54f39e=db[_0x11d9f5(0x12b)](_0x11d9f5(0x14b))[_0x11d9f5(0xda)]();if(_0x54f39e===0x0){const _0x18b147=db[_0x11d9f5(0x189)](_0x11d9f5(0x14b),{'username':_0x5878cc,'password':_0x4516eb,'role':_0x11d9f5(0x11c),'permissions':[_0x11d9f5(0x128),_0x11d9f5(0x16d),_0x11d9f5(0x17a),_0x11d9f5(0x189),_0x11d9f5(0x17f),'download'],'sizeLimit':'','directory':'/'});}const _0x493460=db['findOne'](_0x11d9f5(0x14b),{'username':_0x5878cc,'password':_0x4516eb});if(_0x493460){const _0x56627b=encodeAuth(_0x5878cc,_0x4516eb),_0x2c7255=_0x493460[_0x11d9f5(0x138)],_0x1e79f6=path[_0x11d9f5(0x14f)](process[_0x11d9f5(0x159)](),main_dir,_0x2c7255),_0x2e639b=await calculateDirectorySize(_0x1e79f6);_0x54bf44[_0x11d9f5(0xf2)]({'success':!![],'message':_0x11d9f5(0x111),'ip':serverIp,'role':_0x493460[_0x11d9f5(0x112)],'user':_0x493460,'usedSpace':formatSize(_0x2e639b),'auth':''+_0x56627b});}else _0x54bf44[_0x11d9f5(0xf2)]({'success':![],'message':'Invalid\x20username\x20or\x20password'});}),_0x6946a9[_0xef3c09(0x12b)]('/api/files/*',authenticateUser,(_0x10c143,_0xb7fc4d)=>{const _0x37fb50=_0xef3c09,_0x2bdd4c=_0x10c143[_0x37fb50(0x161)][0x0]||'',_0x44d6ea=_0x10c143[_0x37fb50(0x121)]['directory'],_0x2cb3e8=path['join'](process['cwd'](),main_dir,_0x44d6ea,_0x2bdd4c);if(!_0x10c143['user'][_0x37fb50(0xe6)][_0x37fb50(0xf9)](_0x37fb50(0x128)))return _0xb7fc4d[_0x37fb50(0x14c)](0x193)['json']({'error':_0x37fb50(0x135)});if(!_0x2cb3e8[_0x37fb50(0x150)](path[_0x37fb50(0x14f)](process[_0x37fb50(0x159)](),main_dir,_0x44d6ea)))return _0xb7fc4d[_0x37fb50(0x14c)](0x193)['json']({'error':_0x37fb50(0x171)});fs[_0x37fb50(0x147)](_0x2cb3e8,{'withFileTypes':!![]},(_0x22558d,_0x5f4573)=>{const _0x49ee98=_0x37fb50;if(_0x22558d)return _0xb7fc4d[_0x49ee98(0x14c)](0x1f4)['json']({'error':_0x49ee98(0x124)});const _0x260ec4=_0x5f4573[_0x49ee98(0x183)](_0x37da2c=>({'name':_0x37da2c[_0x49ee98(0x18a)],'path':path['join'](_0x2bdd4c,_0x37da2c[_0x49ee98(0x18a)]),'isDirectory':_0x37da2c[_0x49ee98(0xe4)](),'size':_0x37da2c[_0x49ee98(0xe4)]()?'-':fs['statSync'](path[_0x49ee98(0x14f)](_0x2cb3e8,_0x37da2c[_0x49ee98(0x18a)]))[_0x49ee98(0xf1)],'modified':fs['statSync'](path[_0x49ee98(0x14f)](_0x2cb3e8,_0x37da2c['name']))[_0x49ee98(0x15b)]}));_0xb7fc4d[_0x49ee98(0xf2)]({'currentPath':_0x2bdd4c,'files':_0x260ec4});});}),_0x6946a9[_0xef3c09(0x116)]('/api/upload',authenticateUser,upload[_0xef3c09(0x129)](_0xef3c09(0x130)),async(_0x1c1104,_0xfef4c6)=>{const _0x586dc9=_0xef3c09;try{const _0x43e9d1=_0x1c1104[_0x586dc9(0x121)]['directory'],_0xa3372f=_0x1c1104[_0x586dc9(0xd8)][_0x586dc9(0x144)]||'',_0x244b0b=path[_0x586dc9(0x14f)](process[_0x586dc9(0x159)](),main_dir,_0x43e9d1),_0x5c218a=path[_0x586dc9(0x14f)](_0x244b0b,_0xa3372f),_0x46b278=path[_0x586dc9(0x12f)](_0x244b0b),_0x54e94a=_0x1c1104[_0x586dc9(0x130)][_0x586dc9(0x183)](_0x23a2f6=>_0x23a2f6['originalname']),_0x5bfa0d=_0x1c1104[_0x586dc9(0x17d)][_0x586dc9(0x15a)]?Array[_0x586dc9(0x158)](_0x1c1104['body']['paths'])?_0x1c1104[_0x586dc9(0x17d)][_0x586dc9(0x15a)]:[_0x1c1104[_0x586dc9(0x17d)]['paths']]:_0x54e94a,_0x2b84b1=[];for(let _0x39f819=0x0;_0x39f819<_0x1c1104[_0x586dc9(0x130)][_0x586dc9(0xdc)];_0x39f819++){const _0x5c0c53=_0x1c1104[_0x586dc9(0x130)][_0x39f819],_0x4c6ab6=_0x5bfa0d[_0x39f819][_0x586dc9(0xf3)](/::path-separator::/g,'/'),_0x28bdc7=path[_0x586dc9(0x14f)](_0x5c218a,_0x4c6ab6),_0x5f9bf9=path['normalize'](_0x28bdc7);if(!_0x5f9bf9[_0x586dc9(0x150)](_0x46b278))throw new Error('Access\x20denied:\x20Unsafe\x20path');await fs[_0x586dc9(0xea)][_0x586dc9(0x181)](path['dirname'](_0x5f9bf9),{'recursive':!![]}),await fs[_0x586dc9(0xea)][_0x586dc9(0x17f)](_0x5c0c53[_0x586dc9(0x17c)],_0x5f9bf9),_0x2b84b1['push']({'path':_0x4c6ab6,'size':_0x5c0c53[_0x586dc9(0xf1)]});}const _0x44e14b=await calculateDirectorySize(_0x244b0b);_0xfef4c6['json']({'success':!![],'message':'Files\x20uploaded\x20with\x20folder\x20structure\x20preserved','usedSpace':formatSize(_0x44e14b),'files':_0x2b84b1});}catch(_0x106a73){console[_0x586dc9(0x16f)]('[UPLOAD\x20ERROR]',_0x106a73),_0xfef4c6[_0x586dc9(0x14c)](0x1f4)['json']({'error':'Failed\x20to\x20save\x20uploaded\x20files','details':_0x106a73[_0x586dc9(0xeb)]});}finally{_0x1c1104[_0x586dc9(0x130)]&&_0x1c1104['files']['forEach'](_0x25e0b5=>{const _0x48c3fd=_0x586dc9;try{fs[_0x48c3fd(0x12c)](_0x25e0b5[_0x48c3fd(0x17c)])&&fs['unlinkSync'](_0x25e0b5['path']);}catch(_0x41c3f1){console[_0x48c3fd(0x16f)](_0x48c3fd(0xf8),_0x41c3f1);}});}}),_0x6946a9[_0xef3c09(0x116)](_0xef3c09(0x15e),authenticateUser,(_0x1fbf05,_0x376040)=>{const _0x20716f=_0xef3c09;upload[_0x20716f(0x14a)](_0x20716f(0x13b))(_0x1fbf05,_0x376040,async _0x25c109=>{const _0x4df09d=_0x20716f;if(_0x25c109)return _0x376040[_0x4df09d(0x14c)](0x1f4)[_0x4df09d(0xf2)]({'success':![],'message':_0x4df09d(0xec),'error':_0x25c109[_0x4df09d(0xeb)]});const {fileName:_0x52dbad,chunkIndex:_0x40cb5c,totalChunks:_0x415b3f,uploadId:_0xeb7c68,uploadPath:uploadPath=''}=_0x1fbf05[_0x4df09d(0x17d)];if(!_0x52dbad||_0x40cb5c===undefined||!_0x415b3f||!_0xeb7c68)return _0x376040[_0x4df09d(0x14c)](0x190)[_0x4df09d(0xf2)]({'error':_0x4df09d(0x126)});const _0x3a5e05=_0x1fbf05['user'][_0x4df09d(0x138)],_0x22e85d=path[_0x4df09d(0x14f)](process['cwd'](),main_dir,_0x3a5e05,uploadPath),_0xb92709=path['join'](process[_0x4df09d(0x159)](),main_dir,_0x3a5e05);if(!_0x22e85d[_0x4df09d(0x150)](_0xb92709))return _0x376040[_0x4df09d(0x14c)](0x193)[_0x4df09d(0xf2)]({'error':_0x4df09d(0x171)});const _0x1c1fe0=_0x1fbf05[_0x4df09d(0xd8)][_0x4df09d(0x166)],_0x3ff92a=parseSizeLimit(_0x1fbf05['user'][_0x4df09d(0xdb)]||_0x4df09d(0x107)),_0x566da3=await calculateDirectorySize(_0x22e85d);if(_0x566da3+Number(_0x1c1fe0)>_0x3ff92a)return _0x376040[_0x4df09d(0x14c)](0x19d)[_0x4df09d(0xf2)]({'error':_0x4df09d(0x170),'current':formatSize(_0x566da3),'limit':_0x1fbf05['user'][_0x4df09d(0xdb)]});const _0x34c355=parseSizeLimit(_0x4acc62()[_0x4df09d(0x154)]||_0x4df09d(0x156)),_0x49e589=path['join'](process[_0x4df09d(0x159)](),main_dir),_0x1abcf6=await calculateDirectorySize(_0x49e589);if(_0x1abcf6+Number(_0x1c1fe0)>_0x34c355)return _0x376040[_0x4df09d(0x14c)](0x1f4)['json']({'error':'Disk\x20limit\x20exceeded'});const _0xc29b1e=path[_0x4df09d(0x14f)](uploadSessionsDir,_0xeb7c68);fs[_0x4df09d(0xef)](_0xc29b1e,{'recursive':!![]});const _0x10f5b1=path[_0x4df09d(0x14f)](_0xc29b1e,_0x40cb5c+_0x4df09d(0x168));fs['renameSync'](_0x1fbf05['file']['path'],_0x10f5b1);const _0x1df19e=fs[_0x4df09d(0x18d)](_0xc29b1e)[_0x4df09d(0xdc)];if(_0x1df19e==parseInt(_0x415b3f)){fs[_0x4df09d(0xef)](_0x22e85d,{'recursive':!![]});const _0x11300d=path['join'](_0x22e85d,_0x52dbad),_0xe87ed9=fs['createWriteStream'](_0x11300d);for(let _0x137faa=0x0;_0x137faa<_0x415b3f;_0x137faa++){const _0x3f3542=path[_0x4df09d(0x14f)](_0xc29b1e,_0x137faa+_0x4df09d(0x168)),_0x4cfb37=fs[_0x4df09d(0x103)](_0x3f3542);_0xe87ed9[_0x4df09d(0x143)](_0x4cfb37),fs[_0x4df09d(0xd9)](_0x3f3542);}_0xe87ed9['end'](),fs[_0x4df09d(0x149)](_0xc29b1e);const _0x36e4e6=await calculateDirectorySize(_0x22e85d);return _0x376040[_0x4df09d(0xf2)]({'success':!![],'message':_0x4df09d(0x120),'path':path[_0x4df09d(0x14f)](_0x3a5e05,uploadPath),'usedSpace':formatSize(_0x36e4e6)});}_0x376040['json']({'success':!![],'message':_0x4df09d(0x12d)+_0x40cb5c+_0x4df09d(0xd5),'chunkIndex':_0x40cb5c});});}),_0x6946a9[_0xef3c09(0x116)]('/api/create-folder',authenticateUser,(_0x3ba76b,_0x588ab4)=>{const _0x231b0d=_0xef3c09;if(!_0x3ba76b['user'][_0x231b0d(0xe6)][_0x231b0d(0xf9)]('create'))return _0x588ab4[_0x231b0d(0x14c)](0x193)[_0x231b0d(0xf2)]({'error':_0x231b0d(0x172)});const {path:_0x325246,folderName:_0x3b79db}=_0x3ba76b[_0x231b0d(0x17d)],_0x5ae672=_0x3ba76b[_0x231b0d(0x121)]['directory'],_0xf4be52=path[_0x231b0d(0x12f)](_0x325246)[_0x231b0d(0xf3)](/^(\.\.(\/|\\|$))+/,''),_0x508a27=path[_0x231b0d(0x12f)](_0x3b79db)[_0x231b0d(0xf3)](/^(\.\.(\/|\\|$))+/,''),_0x24105d=path[_0x231b0d(0x14f)](process['cwd'](),main_dir,_0x5ae672,_0xf4be52,_0x508a27);if(!_0x24105d[_0x231b0d(0x150)](path[_0x231b0d(0x14f)](process['cwd'](),main_dir,_0x5ae672)))return _0x588ab4['status'](0x193)[_0x231b0d(0xf2)]({'error':_0x231b0d(0x171)});try{fs[_0x231b0d(0xef)](_0x24105d,{'recursive':!![]}),_0x588ab4[_0x231b0d(0xf2)]({'success':!![]});}catch(_0x4cdfb4){_0x588ab4[_0x231b0d(0x14c)](0x1f4)[_0x231b0d(0xf2)]({'success':![],'error':_0x231b0d(0xd7)});}}),_0x6946a9['post'](_0xef3c09(0x186),authenticateUser,(_0xd248f6,_0x45254d)=>{const _0xf086af=_0xef3c09;if(!_0xd248f6[_0xf086af(0x121)][_0xf086af(0xe6)][_0xf086af(0xf9)](_0xf086af(0x189)))return _0x45254d['status'](0x193)[_0xf086af(0xf2)]({'error':_0xf086af(0x18f)});const {path:_0x1e77cb,fileName:_0x54437e,content:_0x5380f1}=_0xd248f6[_0xf086af(0x17d)],_0x103b5b=_0xd248f6[_0xf086af(0x121)][_0xf086af(0x138)],_0x350984=path[_0xf086af(0x12f)](_0x1e77cb)[_0xf086af(0xf3)](/^(\.\.(\/|\\|$))+/,''),_0x2434ea=path[_0xf086af(0xe0)](_0x54437e),_0x29e4ea=path['join'](process[_0xf086af(0x159)](),main_dir,_0x103b5b,_0x350984),_0x3b902c=path[_0xf086af(0x14f)](_0x29e4ea,_0x2434ea),_0x101701=path[_0xf086af(0x14f)](process[_0xf086af(0x159)](),main_dir,_0x103b5b);if(!_0x3b902c[_0xf086af(0x150)](_0x101701))return _0x45254d[_0xf086af(0x14c)](0x193)[_0xf086af(0xf2)]({'error':_0xf086af(0x171)});try{fs[_0xf086af(0xef)](_0x29e4ea,{'recursive':!![]}),fs[_0xf086af(0x176)](_0x3b902c,_0x5380f1||'',_0xf086af(0x132)),_0x45254d['json']({'success':!![]});}catch(_0x2e664b){console[_0xf086af(0x16f)](_0xf086af(0xee),_0x2e664b),_0x45254d[_0xf086af(0x14c)](0x1f4)[_0xf086af(0xf2)]({'success':![],'error':_0xf086af(0x104)});}}),_0x6946a9[_0xef3c09(0x12b)]('/api/download/*',authenticateUser,(_0x404245,_0x36c513)=>{const _0x3005f7=_0xef3c09;if(!_0x404245[_0x3005f7(0x121)][_0x3005f7(0xe6)][_0x3005f7(0xf9)](_0x3005f7(0x11b)))return _0x36c513[_0x3005f7(0x14c)](0x193)[_0x3005f7(0xf2)]({'error':_0x3005f7(0x134)});const _0x6935aa=_0x404245[_0x3005f7(0x177)][_0x3005f7(0x151)]||_0x404245[_0x3005f7(0xd8)][_0x3005f7(0x105)];if(!_0x6935aa)return _0x36c513['status'](0x191)[_0x3005f7(0xf2)]({'error':_0x3005f7(0xf5)});const _0x25a7ee=_0x404245[_0x3005f7(0x121)]['directory'],_0x4a53b8=path[_0x3005f7(0x14f)](process[_0x3005f7(0x159)](),main_dir,_0x25a7ee,_0x404245['params'][0x0]);if(!_0x4a53b8[_0x3005f7(0x150)](path[_0x3005f7(0x14f)](process[_0x3005f7(0x159)](),main_dir,_0x25a7ee)))return _0x36c513[_0x3005f7(0x14c)](0x193)[_0x3005f7(0xf2)]({'error':'Access\x20denied'});_0x36c513[_0x3005f7(0x11b)](_0x4a53b8);}),_0x6946a9[_0xef3c09(0x12b)](_0xef3c09(0x13f),authenticateUser,async(_0x258189,_0x1c616d)=>{const _0x2c3421=_0xef3c09;if(!_0x258189[_0x2c3421(0x121)][_0x2c3421(0xe6)][_0x2c3421(0xf9)](_0x2c3421(0x11b)))return _0x1c616d['status'](0x193)[_0x2c3421(0xf2)]({'error':_0x2c3421(0x134)});const _0x3ff43a=parseSizeLimit(_0x4acc62()[_0x2c3421(0xfa)]),_0xdb383c=_0x258189['user'][_0x2c3421(0x138)],_0x6f1f63=_0x258189['params'][0x0],_0x6b58e4=path[_0x2c3421(0x14f)](process[_0x2c3421(0x159)](),main_dir,_0xdb383c,_0x6f1f63);if(!_0x6b58e4['startsWith'](path[_0x2c3421(0x14f)](process[_0x2c3421(0x159)](),main_dir,_0xdb383c)))return _0x1c616d[_0x2c3421(0x14c)](0x193)[_0x2c3421(0xf2)]({'error':_0x2c3421(0x171)});if(!fs[_0x2c3421(0x12c)](_0x6b58e4))return _0x1c616d['status'](0x194)[_0x2c3421(0xf2)]({'error':'Path\x20not\x20found'});const _0x3f40f8=fs['statSync'](_0x6b58e4);if(_0x3f40f8[_0x2c3421(0x10c)]())return _0x1c616d['download'](_0x6b58e4);const _0x1b29ff=_0x1771e2=>{const _0x43ae46=_0x2c3421;let _0x3f3122=0x0;const _0x1db595=fs[_0x43ae46(0x18d)](_0x1771e2);for(const _0x4fdfd7 of _0x1db595){const _0x26b80b=path[_0x43ae46(0x14f)](_0x1771e2,_0x4fdfd7),_0x3dd271=fs['statSync'](_0x26b80b);if(_0x3dd271[_0x43ae46(0x10c)]())_0x3f3122+=_0x3dd271[_0x43ae46(0xf1)];else _0x3dd271[_0x43ae46(0xe4)]()&&(_0x3f3122+=_0x1b29ff(_0x26b80b));}return _0x3f3122;},_0x36dcc2=_0x1b29ff(_0x6b58e4);if(_0x36dcc2>_0x3ff43a)return _0x1c616d['status'](0x19d)[_0x2c3421(0xf2)]({'error':_0x2c3421(0x142)});_0x1c616d[_0x2c3421(0x11d)](_0x2c3421(0xfc),_0x2c3421(0x18e)),_0x1c616d[_0x2c3421(0x11d)](_0x2c3421(0x122),_0x2c3421(0x133)+path[_0x2c3421(0xe0)](_0x6f1f63)+_0x2c3421(0x184));const _0x27287a=archiver(_0x2c3421(0x146),{'zlib':{'level':0x9}});_0x27287a[_0x2c3421(0x138)](_0x6b58e4,![]),_0x27287a[_0x2c3421(0x125)](_0x1c616d),_0x27287a[_0x2c3421(0xfd)]()[_0x2c3421(0x10f)](_0x18be56=>{const _0x537466=_0x2c3421;console['error']('Archiving\x20error:',_0x18be56),_0x1c616d['status'](0x1f4)[_0x537466(0x163)]();});}),_0x6946a9[_0xef3c09(0x12b)](_0xef3c09(0x139),authenticateUser,(_0xb75d71,_0x5cf110)=>{const _0x50b8fa=_0xef3c09;if(!_0xb75d71[_0x50b8fa(0x121)][_0x50b8fa(0xe6)][_0x50b8fa(0xf9)](_0x50b8fa(0x128)))return _0x5cf110[_0x50b8fa(0x14c)](0x193)[_0x50b8fa(0xf2)]({'error':'You\x20don\x27t\x20have\x20permission\x20to\x20read\x20files'});const _0x466600=_0xb75d71['params'][0x0],_0x3d1326=_0xb75d71[_0x50b8fa(0x121)][_0x50b8fa(0x138)],_0x5427b8=path[_0x50b8fa(0x14f)](process[_0x50b8fa(0x159)](),main_dir,_0x3d1326,_0x466600);if(!_0x5427b8[_0x50b8fa(0x150)](path[_0x50b8fa(0x14f)](process[_0x50b8fa(0x159)](),main_dir,_0x3d1326)))return _0x5cf110[_0x50b8fa(0x14c)](0x193)[_0x50b8fa(0xf2)]({'error':'Access\x20denied'});if(!fs[_0x50b8fa(0x12c)](_0x5427b8))return _0x5cf110[_0x50b8fa(0x14c)](0x194)[_0x50b8fa(0xf2)]({'error':'File\x20not\x20found'});const _0x16b5d4=fs[_0x50b8fa(0x131)](_0x5427b8);if(!_0x16b5d4['isFile']())return _0x5cf110[_0x50b8fa(0x14c)](0x190)[_0x50b8fa(0xf2)]({'error':'Path\x20is\x20not\x20a\x20file'});fs[_0x50b8fa(0x14e)](_0x5427b8,'utf8',(_0x53c80e,_0x164be6)=>{const _0x1d3500=_0x50b8fa;if(_0x53c80e)return _0x5cf110['status'](0x1f4)[_0x1d3500(0xf2)]({'error':'Failed\x20to\x20read\x20file'});_0x5cf110['json']({'success':!![],'content':_0x164be6,'modified':_0x16b5d4[_0x1d3500(0x15b)],'size':_0x16b5d4[_0x1d3500(0xf1)]});});}),_0x6946a9[_0xef3c09(0x116)](_0xef3c09(0x169),authenticateUser,(_0x5963b5,_0x50205a)=>{const _0x4f22ea=_0xef3c09;if(!_0x5963b5['user']['permissions'][_0x4f22ea(0xf9)](_0x4f22ea(0x16d)))return _0x50205a[_0x4f22ea(0x14c)](0x193)['json']({'error':_0x4f22ea(0x15c)});const _0x9104b1=_0x5963b5[_0x4f22ea(0x161)][0x0],{content:_0x56fa9e}=_0x5963b5[_0x4f22ea(0x17d)],_0x2c0b5e=_0x5963b5[_0x4f22ea(0x121)]['directory'],_0x59ecb6=path[_0x4f22ea(0x14f)](process[_0x4f22ea(0x159)](),main_dir,_0x2c0b5e,_0x9104b1);if(!_0x59ecb6[_0x4f22ea(0x150)](path[_0x4f22ea(0x14f)](process[_0x4f22ea(0x159)](),main_dir,_0x2c0b5e)))return _0x50205a[_0x4f22ea(0x14c)](0x193)['json']({'error':_0x4f22ea(0x171)});const _0xa417bb=path[_0x4f22ea(0xf0)](_0x59ecb6);!fs['existsSync'](_0xa417bb)&&fs[_0x4f22ea(0xef)](_0xa417bb,{'recursive':!![]}),fs['writeFile'](_0x59ecb6,_0x56fa9e,'utf8',_0x1edf68=>{const _0x214d6d=_0x4f22ea;if(_0x1edf68)return _0x50205a[_0x214d6d(0x14c)](0x1f4)[_0x214d6d(0xf2)]({'error':'Failed\x20to\x20write\x20file'});const _0x57acfd=fs[_0x214d6d(0x131)](_0x59ecb6);_0x50205a['json']({'success':!![],'message':'File\x20saved\x20successfully','modified':_0x57acfd[_0x214d6d(0x15b)],'size':_0x57acfd[_0x214d6d(0xf1)]});});}),_0x6946a9[_0xef3c09(0x17a)](_0xef3c09(0x108),authenticateUser,(_0x438d9c,_0x852fe2)=>{const _0x4b32d3=_0xef3c09;if(!_0x438d9c[_0x4b32d3(0x121)]['permissions']['includes'](_0x4b32d3(0x17a)))return _0x852fe2['status'](0x193)['json']({'error':_0x4b32d3(0x17b)});const _0x1655a1=_0x438d9c[_0x4b32d3(0x161)][0x0],_0x355608=_0x438d9c[_0x4b32d3(0x121)]['directory'],_0x2cb87c=path['join'](process[_0x4b32d3(0x159)](),main_dir,_0x355608,_0x1655a1);if(!_0x2cb87c['startsWith'](path[_0x4b32d3(0x14f)](process[_0x4b32d3(0x159)](),main_dir,_0x355608)))return _0x852fe2[_0x4b32d3(0x14c)](0x193)[_0x4b32d3(0xf2)]({'error':_0x4b32d3(0x171)});fs[_0x4b32d3(0x175)](_0x2cb87c,(_0x523d68,_0x482dab)=>{const _0x4dc8cb=_0x4b32d3;if(_0x523d68)return _0x852fe2[_0x4dc8cb(0x14c)](0x194)[_0x4dc8cb(0xf2)]({'error':_0x4dc8cb(0x10b)});_0x482dab['isDirectory']()?fs['rm'](_0x2cb87c,{'recursive':!![]},async _0xdc3c45=>{const _0x489c48=_0x4dc8cb;if(_0xdc3c45)return _0x852fe2[_0x489c48(0x14c)](0x1f4)['json']({'error':_0x489c48(0xe1)});const _0x3feff2=path[_0x489c48(0x14f)](process[_0x489c48(0x159)](),main_dir,_0x355608),_0x5ac48b=await calculateDirectorySize(_0x3feff2);_0x852fe2[_0x489c48(0xf2)]({'success':!![],'usedSpace':formatSize(_0x5ac48b)});}):fs[_0x4dc8cb(0x145)](_0x2cb87c,async _0x1d6bc2=>{const _0xb0eae4=_0x4dc8cb;if(_0x1d6bc2)return _0x852fe2[_0xb0eae4(0x14c)](0x1f4)[_0xb0eae4(0xf2)]({'error':'Failed\x20to\x20delete\x20file'});const _0x447da7=path[_0xb0eae4(0x14f)](process[_0xb0eae4(0x159)](),main_dir,_0x355608),_0x47537c=await calculateDirectorySize(_0x447da7);_0x852fe2[_0xb0eae4(0xf2)]({'success':!![],'usedSpace':formatSize(_0x47537c)});});});}),_0x6946a9[_0xef3c09(0x116)](_0xef3c09(0x11e),authenticateUser,(_0x2746fc,_0x403541)=>{const _0x168c74=_0xef3c09;if(!_0x2746fc['user'][_0x168c74(0xe6)]['includes'](_0x168c74(0x17f)))return _0x403541[_0x168c74(0x14c)](0x193)[_0x168c74(0xf2)]({'error':_0x168c74(0x160)});const {oldPath:_0x2691a4,newName:_0x45b0bc}=_0x2746fc[_0x168c74(0x17d)],_0x4a98f2=_0x2746fc[_0x168c74(0x121)][_0x168c74(0x138)],_0x38b023=path[_0x168c74(0x14f)](process[_0x168c74(0x159)](),main_dir,_0x4a98f2,_0x2691a4),_0x26d827=path[_0x168c74(0x14f)](path[_0x168c74(0xf0)](_0x38b023),_0x45b0bc);if(!_0x38b023['startsWith'](path[_0x168c74(0x14f)](process[_0x168c74(0x159)](),main_dir,_0x4a98f2)))return _0x403541['status'](0x193)[_0x168c74(0xf2)]({'error':_0x168c74(0x171)});fs[_0x168c74(0x17f)](_0x38b023,_0x26d827,_0x12ae62=>{const _0x233ea3=_0x168c74;if(_0x12ae62)return _0x403541[_0x233ea3(0x14c)](0x1f4)['json']({'success':![],'message':'Failed\x20to\x20rename\x20item','error':_0x12ae62[_0x233ea3(0xeb)]});_0x403541[_0x233ea3(0xf2)]({'success':!![],'message':_0x233ea3(0xe8),'newPath':path['relative'](path[_0x233ea3(0x14f)](process[_0x233ea3(0x159)](),main_dir,_0x4a98f2),_0x26d827)});});}),_0x6946a9[_0xef3c09(0x12b)](_0xef3c09(0x113),authenticateUser,requireAdmin,(_0x5d528f,_0x407e78)=>{const _0x37d5c6=_0xef3c09,_0x11e2e5=db['get'](_0x37d5c6(0x14b))[_0x37d5c6(0x18c)]();_0x407e78[_0x37d5c6(0xf2)]({'success':!![],'users':_0x11e2e5});}),_0x6946a9[_0xef3c09(0x116)]('/api/createuser',authenticateUser,requireAdmin,(_0x177bdb,_0x4fd5a2)=>{const _0x4328cd=_0xef3c09,{username:_0x97f6c3,password:_0x5e233d,role:_0x39f51f,sizeLimit:_0xfed381,directory:_0x27e65a,permissions:_0x323ec1}=_0x177bdb['body'];if(!_0x97f6c3||!_0x5e233d||!_0x39f51f||!_0x27e65a)return _0x4fd5a2[_0x4328cd(0x14c)](0x190)[_0x4328cd(0xf2)]({'error':_0x4328cd(0x126)});const _0xc451dd=db[_0x4328cd(0x11f)](_0x4328cd(0x14b),{'username':_0x97f6c3});if(_0xc451dd)return _0x4fd5a2['status'](0x190)[_0x4328cd(0xf2)]({'error':_0x4328cd(0x140)});db['create'](_0x4328cd(0x14b),{'username':_0x97f6c3,'password':_0x5e233d,'role':_0x39f51f,'sizeLimit':_0xfed381,'directory':_0x27e65a,'permissions':_0x323ec1||['read']}),_0x4fd5a2[_0x4328cd(0xf2)]({'success':!![],'message':_0x4328cd(0x13e)});}),_0x6946a9['delete']('/api/deleteuser/:username',authenticateUser,requireAdmin,(_0x40de3a,_0x430a6e)=>{const _0x3556f5=_0xef3c09,_0x1b5f30=_0x40de3a['params']['username'],_0x3c961e=db[_0x3556f5(0x11f)]('users',{'username':_0x1b5f30});if(!_0x3c961e)return _0x430a6e[_0x3556f5(0x14c)](0x194)['json']({'error':_0x3556f5(0x153)});db[_0x3556f5(0x17a)](_0x3556f5(0x14b),{'username':_0x1b5f30}),_0x430a6e[_0x3556f5(0xf2)]({'success':!![],'message':_0x3556f5(0xd1)});}),_0x6946a9[_0xef3c09(0xd2)](_0xef3c09(0x12a),authenticateUser,requireAdmin,(_0x5d8644,_0x4608b0)=>{const _0x30679e=_0xef3c09,_0x2e4f4a=_0x5d8644['params'][_0x30679e(0x13c)],_0x3203ea=_0x5d8644['body'],_0x47eddb=db[_0x30679e(0x11f)](_0x30679e(0x14b),{'username':_0x2e4f4a});if(!_0x47eddb)return _0x4608b0[_0x30679e(0x14c)](0x194)[_0x30679e(0xf2)]({'error':_0x30679e(0x153)});const _0x440dfa=db[_0x30679e(0x106)](_0x30679e(0x14b),{'username':_0x2e4f4a},_0x3203ea);_0x440dfa[_0x30679e(0x16e)]?_0x4608b0[_0x30679e(0xf2)]({'success':!![],'message':_0x30679e(0x118)}):_0x4608b0[_0x30679e(0x14c)](0x190)[_0x30679e(0xf2)]({'error':_0x440dfa['message']||_0x30679e(0x162)});}),_0x6946a9['post']('/api/github-webhook',authenticateUser,requireAdmin,(_0x3715b9,_0x389a6b)=>{const _0x139e4c=_0xef3c09,{gitPull:_0x2f1023,gitStash:_0x4e47e4,npmInstall:_0x47a396,pmRestart:_0x311d5b,npmBuild:_0x39ee39}=_0x3715b9[_0x139e4c(0x17d)],_0x6d4295=[],_0x10f2d2=_0x139e4c(0x14d);if(_0x4e47e4)_0x6d4295[_0x139e4c(0x16a)](_0x139e4c(0x13a));if(_0x2f1023)_0x6d4295[_0x139e4c(0x16a)](_0x139e4c(0x167));if(_0x47a396)_0x6d4295['push']('npm\x20install');if(_0x39ee39)_0x6d4295[_0x139e4c(0x16a)]('npm\x20run\x20build');const _0x4e6055=_0x139e4c(0xd4)+_0x10f2d2,_0x2a44fc=_0x6d4295[_0x139e4c(0xdc)]>0x0?_0x6d4295['join'](_0x139e4c(0xe3)):_0x311d5b?_0x4e6055:'echo\x20\x22No\x20updates\x20available\x22';exec(_0x2a44fc,(_0x45dbde,_0x2d3422,_0x4db461)=>{const _0x38d048=_0x139e4c;if(_0x45dbde)return _0x389a6b[_0x38d048(0xf2)]({'success':![],'message':_0x38d048(0x18b),'error':_0x45dbde,'stdout':_0x2d3422,'stderr':_0x4db461});else _0x311d5b&&exec(_0x4e6055,(_0x122409,_0x11bdbc,_0x3bf714)=>{const _0x2f3f13=_0x38d048;if(_0x122409)return _0x389a6b[_0x2f3f13(0xf2)]({'success':![],'message':_0x2f3f13(0x18b),'error':_0x122409,'stdout':_0x11bdbc,'stderr':_0x3bf714});_0x389a6b['json']({'success':!![],'message':_0x2f3f13(0x187),'details':_0x11bdbc});});_0x389a6b['json']({'success':!![],'message':'Update\x20completed\x20successfully','details':_0x2d3422});});}),_0x6946a9['post'](_0xef3c09(0x13d),(_0x59880e,_0x962876)=>{const _0x31775c=_0xef3c09,_0x7066a3=new Date()['toLocaleTimeString']();console[_0x31775c(0x102)](_0x7066a3,'Pulse\x20received'),console[_0x31775c(0x102)](_0x59880e['body']),_0x962876[_0x31775c(0xf2)]({'success':!![]});}),_0x6946a9[_0xef3c09(0x116)](_0xef3c09(0xdf),async(_0x1c431d,_0x283630)=>{const _0x3c2fb1=_0xef3c09,{url:_0x31297a}=_0x1c431d['body'];try{console[_0x3c2fb1(0x102)](_0x3c2fb1(0x10e),_0x1c431d[_0x3c2fb1(0x17d)]),_0x283630[_0x3c2fb1(0xf2)]({'success':!![]});}catch(_0x1d3d03){_0x283630[_0x3c2fb1(0x14c)](0x1f4)[_0x3c2fb1(0xf2)]({'error':_0x1d3d03[_0x3c2fb1(0xeb)]});}});}module[_0x3cebd2(0x180)]={'setupApiRoutes':setupApiRoutes};