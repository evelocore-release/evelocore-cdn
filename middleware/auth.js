const _0x180874=_0x3b04;(function(_0x3bed83,_0x5a10d9){const _0xed4726=_0x3b04,_0x22dda8=_0x3bed83();while(!![]){try{const _0x2220d7=-parseInt(_0xed4726(0x163))/0x1+parseInt(_0xed4726(0x153))/0x2+-parseInt(_0xed4726(0x161))/0x3+-parseInt(_0xed4726(0x162))/0x4*(parseInt(_0xed4726(0x166))/0x5)+parseInt(_0xed4726(0x149))/0x6+parseInt(_0xed4726(0x15d))/0x7+-parseInt(_0xed4726(0x160))/0x8*(-parseInt(_0xed4726(0x15b))/0x9);if(_0x2220d7===_0x5a10d9)break;else _0x22dda8['push'](_0x22dda8['shift']());}catch(_0x19ee6e){_0x22dda8['push'](_0x22dda8['shift']());}}}(_0x37f5,0x2719d));function _0x37f5(){const _0x1a6a84=['No\x20authorization\x20header','user','concat','Invalid\x20encrypted\x20data\x20format','createHash','base64','exit','Basic\x20','Invalid\x20authentication\x20token','1036692MwKafZ','final','authorization','crypto','utf-8','omh7tLUQ/LPu3OSF3hNRKMUT5CP7WPQ9ECe40VJ7ez0=','digest','update','evelodb','split','250962MzUFDd','users','createDecipheriv','randomBytes','status','toString','aes-256-cbc','Invalid\x20credentials','24849acgKda','from','559643sLsKSF','json','findOne','1432ybdWcE','824322OLsUGy','14196AkJVHa','228109SfaYlm','createCipheriv','error','295DSQLUU'];_0x37f5=function(){return _0x1a6a84;};return _0x37f5();}const evelodbConfig=require('./evelodb-config'),eveloDB=require(_0x180874(0x151));let db;try{db=new eveloDB(evelodbConfig);}catch(_0x4c2192){console[_0x180874(0x165)]('Failed\x20to\x20initialize\x20database:',_0x4c2192),process[_0x180874(0x146)](0x1);}const authenticateUser=(_0x50c52c,_0x4545ec,_0x28ffd3)=>{const _0x4dc7ff=_0x180874,_0x32d6b6=_0x50c52c['headers'][_0x4dc7ff(0x14b)];if(!_0x32d6b6)return _0x4545ec[_0x4dc7ff(0x157)](0x191)[_0x4dc7ff(0x15e)]({'error':_0x4dc7ff(0x167)});try{const [_0x145d43,_0x58a1ec]=decodeAuth(_0x32d6b6),_0x50171a=db[_0x4dc7ff(0x15f)](_0x4dc7ff(0x154),{'username':_0x145d43,'password':_0x58a1ec});if(!_0x50171a)return _0x4545ec[_0x4dc7ff(0x157)](0x191)['json']({'error':_0x4dc7ff(0x15a)});_0x50c52c[_0x4dc7ff(0x141)]=_0x50171a,_0x28ffd3();}catch(_0x3877fd){_0x4545ec[_0x4dc7ff(0x157)](0x191)[_0x4dc7ff(0x15e)]({'error':_0x4dc7ff(0x148)});}};function encodeAuthOld(_0x312ff4,_0xe0c005){const _0x22449e=_0x180874,_0x1cc0cd=_0x312ff4+':'+_0xe0c005,_0x1471b7=Buffer[_0x22449e(0x15c)](_0x1cc0cd)[_0x22449e(0x158)]('base64');return _0x22449e(0x147)+_0x1471b7;}function decodeAuthOld(){const _0x2b0051=_0x180874,[_0x819e40,_0x360451]=Buffer[_0x2b0051(0x15c)](authHeader[_0x2b0051(0x152)]('\x20')[0x1],_0x2b0051(0x145))['toString']()[_0x2b0051(0x152)](':');return[_0x819e40,_0x360451];}const crypto=require(_0x180874(0x14c)),AES_SECRET=crypto[_0x180874(0x144)]('sha256')[_0x180874(0x150)](_0x180874(0x14e))[_0x180874(0x14f)]();function encodeAuth(_0x148372,_0x390ad7){const _0x50bb93=_0x180874;if(!_0x148372||!_0x390ad7)throw new Error('Missing\x20credentials');const _0x5872a4=_0x148372+':'+_0x390ad7,_0x26ea5b=crypto[_0x50bb93(0x156)](0x10),_0x1ac93f=crypto[_0x50bb93(0x164)](_0x50bb93(0x159),AES_SECRET,_0x26ea5b),_0x47934d=Buffer[_0x50bb93(0x142)]([_0x1ac93f['update'](_0x5872a4,_0x50bb93(0x14d)),_0x1ac93f[_0x50bb93(0x14a)]()]),_0x3d3484=_0x26ea5b[_0x50bb93(0x158)](_0x50bb93(0x145)),_0x28636a=_0x47934d[_0x50bb93(0x158)]('base64');return _0x3d3484+'.'+_0x28636a;}function _0x3b04(_0xf10742,_0x145554){const _0x37f578=_0x37f5();return _0x3b04=function(_0x3b04f3,_0x17d540){_0x3b04f3=_0x3b04f3-0x141;let _0x288e71=_0x37f578[_0x3b04f3];return _0x288e71;},_0x3b04(_0xf10742,_0x145554);}function decodeAuth(_0x14ee9a){const _0x4d3808=_0x180874;try{if(!_0x14ee9a['includes']('.'))throw new Error(_0x4d3808(0x143));const [_0x4f01d7,_0x2e1e99]=_0x14ee9a[_0x4d3808(0x152)]('.'),_0x1dcc77=Buffer[_0x4d3808(0x15c)](_0x4f01d7,'base64'),_0x30b7d0=Buffer[_0x4d3808(0x15c)](_0x2e1e99,_0x4d3808(0x145)),_0x417a31=crypto[_0x4d3808(0x155)]('aes-256-cbc',AES_SECRET,_0x1dcc77),_0x254d18=Buffer['concat']([_0x417a31[_0x4d3808(0x150)](_0x30b7d0),_0x417a31[_0x4d3808(0x14a)]()]),[_0x18ff9a,_0x2c2e5c]=_0x254d18['toString'](_0x4d3808(0x14d))[_0x4d3808(0x152)](':');return[_0x18ff9a,_0x2c2e5c];}catch(_0x6aaff3){return['',''];}}module['exports']={'authenticateUser':authenticateUser,'encodeAuth':encodeAuth,'decodeAuth':decodeAuth};